# 2.2 最小のプログラムと実際のコード

変数の概念を理解したところで、これから、いよいよ初めてのプログラムを作ります。しかし初めから色々な機能のあるプログラムを作成する事は不可能なので、まずは最小のプログラムを作っていきます。

### 2.2.1 main関数とreturn文
そもそも、C++のプログラムを作るのにどのような知識が必要になるでしょうか。それにはまず、そのプログラム言語の構造を知る事が第一です。

例えば、あなたは木製の椅子を作ろうとしました。しかし木製の椅子を作るには、木製の椅子の構造を知っていなければ、作りあげる事はできませんね。

そして、木製の椅子を作るためには、材料として木が必要です。それらは最終的に木製の椅子の部品となります。という事は、木製の椅子の構造は、部品の集合で成り立っていると言えます。当たり前のことですね。

C++プログラムも同じように、部品の集合で成り立っています。その部品をC++では**関数**と言います。以下の説明では厳密な正しい内容を説明するためまだ説明を終えていない概念が少し出てきます。しかしそういった細かい点が分からなくても、そこで読み進めるのを止めないでください。後で振り返ってこういう事を言っていたのかと理解できれば、大丈夫ですから。

さてここで、C++の最小のコードを見て見ましょう。
```cpp
int main(){}
```
これは、**main関数**と言います。C++のプログラムには、`main`関数が**必ず1つ**(以上でも以下でもありません)なくてはなりません。そしてプログラムは`main`関数から処理が開始されます。実際の処理は、`main`関数の`{}`の中に書きます。しかし、今は何も書いていないので、これは何もしないプログラムです。

細かく意味合いを見ていきます。まず`main`という部分の前に`int`とありますね。これは、**`int`型のデータを返す`main`という名前の関数**という意味になります。

**`int`型のデータを返す**とはなんでしょう？

まずこのプログラムがコンパイル、実行されると、`main`関数は、プログラムを実行した際、一番初めに実行されます。このプログラムが起動した後、このコードには、何も記述されていないので(`{}`の部分)、何もせずに、プログラムを終了する事になります。

そのプログラムを終了する際に、プログラムを実行した元のプログラムへ、数値を返すという慣習があるのです。


例え話ですが、Windowsで「a.exe」というアプリケーションを起動したとします。「a.exe」は正しく処理がされました。しかし、起動元であるWindowsは、そのアプリケーションが正しく処理されたかどうか知ることができません。そこで、「a.exe」というアプリケーションは、例えば`0`という数値をWindowsへ返したとします。そしてWindowsは`0`という数値が返ってくると正常に終了したと認識するとします。ここで初めて、Windowsは「a.exe」というアプリケーションは正常に実行されたという事が認識できるのです。このような事のために、メイン関数から値を返すのです。

実際には、Windowsという所謂OSへ値を返すのではなく、`std::exit`という関数へ値を返します。これは、`std::exit`は以下のような関数です。
```cpp
[[noreturn]] void exit(int status);
```
何やらよく分かりませんね。ここで一つ一つを説明するのはまだ説明していない概念を含んでいる事もあり難しいので、省きます（関数については第6章、attributeについては第10章で説明します)が、プログラムは終了時、自動的に上記の`std::exit`という関数を呼び出します。これのために、値を`main`関数から返さなければならないのです。そして一般的には、`0`もしくは`EXIT_SUCCESS`を返したら正常終了を意味し、`EXIT_FAILURE`を返した場合は異常終了したという意味になります。

つまり、上記の`main`関数だけのコードを厳密に書くのであれば、以下のように書くべきです。

```cpp
int main(){return 0;}
```
か
```cpp
int main(){return EXIT_SUCCESS;}
```
となります。

このように`return value;`と書く事で、その`value`を起動元のプログラムへ返し、その関数の処理が終了します。
しかし、`main`関数は**特別に**`return`文を書かなかった場合、0を返すのと同じ意味になるのです。よって、
```cpp
int main(){}
```
も、正しいプログラムとなります。

### 2.2.2 インデント
先ほど、私は以下が最小のコードだと述べました。

```cpp
int main(){}
```
しかし、これはこのように記述する事ができます。

```cpp
int main()
{
}
```
このように書くこともできます。

```cpp
int main()
{
    }
```
このようにも。

```cpp
int
main(
){
}
```

このように、キーワード単位が守られた記述であれば、どのように改行したりスペースを入れたり、タブを入れたりしても構わない事となっています。このようにスペースやタブ等の事をインデントと言います。<br>ただ一つ注意してほしいのが、全角のスペースです。コードの中には全角のスペースでインデントを入れる事はできません。もし全角スペースでインデントを入れると、コンパイラ(GCC 6.1.0)はこのようなエラーを出力します。
```
t.cpp:3:1: エラー: プログラム内に逸脱した ‘\343’ があります ???
t.cpp:3:2: エラー: プログラム内に逸脱した ‘\200’ があります ???
t.cpp:3:3: エラー: プログラム内に逸脱した ‘\200’ があります ??
```
全角スペースは、視覚的に確認できるものではないので、タイプミスなどで挿入してしまう場合があります。注意しましょう。

### 2.2.3 コメント
ここでついでに、コメント機能についても触れておきましょう。コメントとは、プログラムに注釈のような一言メモを添えておける機能です。実は、ここまでで示したサンプルコードの中にも、いくつかコメントが書かれていました。

```cpp
int x=10; // xには10が入ってます
```
<code>//</code>から先は、プログラム中に日本語が含まれています。<code>//</code>を使う事で<code>//</code>以降その段落はコメントとしてコンパイラに捉えられるので、何を書いても良い事になっています。

```cpp
int x=10; // xには10が入っているはずなんですよね〜〜ああ、お腹すいたな。
```
と書いてもプログラム上は問題ありません。(無関係な内容を書くべきではありません)<br>また、<code>//</code>以外に、<code>/&#42; &#42;/</code>というようなコメント機能もあります。

```cpp
int x=10; /* xには10が入っていると思われるのであります。 */
```
<code>/&#42; &#42;/</code>で囲んでいる範囲はコメントとなるので、何を書いてもプログラム上は問題ありません。(無関係な内容を書くべきではありません)

### 2.2.4 数値演算のプログラム

ここまでで、変数とmain関数の概念を説明しました。以上の概念を用いて、ついに実際のプログラムを作る事ができます。

```cpp
int main()
{
    int a=10,b=10;
    int result=a+b;
}
```
`result`に`a`と`b`の加算結果を得るというプログラムを書く事ができるようになりました。尚、変数宣言は上記のように、`,`を使う事で連続的に変数を宣言する事ができます。動きとしては、下記コードと同じです。

```cpp
int main()
{
    int a=10;
    int b=10;
    int result=a+b;
}
```
ただ、`,`を用いて変数宣言をした以上、`,`で宣言された変数は全てその型となるという事を注意してください。つまり、

```cpp
int main()
{
    int a=10,b=3.14;
}
```
とした場合、bには3が代入されるという事です。3.14を代入したければ、

```cpp
int main()
{
    int a=10;
    double b=3.14;
}
```
のように別の型を用いて定義しなければなりません。