## 5.1 スコープ

C++にはスコープ(範囲)という概念があります。スコープは、通常`{`と`}`で表します。例を見て見ましょう。
```cpp
#include<iostream>
int main()
{
    char a = 'a';    
    {    
        char b = 'b';
    }
    std::cout << a << std::endl << b << std::endl;
}
```
このコードは、コンパイルエラーとなります。コンパイラ(GCC 6.1.0)のエラー文を見て見ましょう。

```cpp
test.cpp: 関数 ‘int main()’ 内:
test.cpp:8:33: エラー: ‘b’ was not declared in this scope
std::cout << a << std::endl << b << std::endl;
                               ^
```
「`b`はこのスコープ内で宣言されていません」というエラーが出ています。まさにエラー文の通り、変数`b`は`main`関数中の`{}`の中に定義されていますので、同じスコープ内からでしかアクセスする事はできません。アクセスしたければ、例えばこのように記述します。
```cpp
#include<iostream>
int main()
{
    char a='a';
    {
        char b='b';
        std::cout << b << std::endl;
    }
    std::cout << a << std::endl;
}
```
実行結果は以下となります。

```cpp
b
a
```
同スコープ内でのアクセスなので`b`への処理が正しく成されている事が分かります。では、内側のスコープから外側のスコープのデータにアクセスする事はできるのでしょうか？

```cpp
#include<iostream>
int main()
{
    char a = 'a';
    {
        std::cout << a << std::endl;
    }
}
```
実行結果は以下となります。
```cpp
a
```
答えはYESです。内側のスコープから外側のスコープへアクセスする事は合法です。因みにスコープは、何重にもする事ができます。例えばこのように。
```cpp
int main()
{
    int a;
    {
        int a;
        {
            int a;
            {
                int a;
            }
        }
    }
}
```
ここで関数`main`の中に変数`a`がいくつも宣言されている事に気付いたかもしれませんが、このコードは正しいのです。何故なら、全ての変数`a`はそれぞれのスコープで宣言された変数`a`でありそれぞれが全て独立しています。以下のようなコードで試して見ましょう。

```cpp
#include<iostream>
int main()
{
    int a = 10;
    {
        int a = 20;
        {
            int a = 30;
            {
                int a = 40;
                std::cout << a << std::endl;
            }
            std::cout << a << std::endl;
        }
        std::cout << a << std::endl;
    }
    std::cout << a << std::endl;
}
```
実行結果は以下となります。

```cpp
40
30
20
10
```
再束縛でなく、全ての変数`a`がそのスコープ内で独立している事が分かると思います。もしそうでなければ、出力結果は全て40となるはずだからです。最後に、スコープによって確保されたデータがどのタイミングで破棄されるのかを説明します。例えば、以下のようなコードがあります。
```cpp
int main()
{
    char c;
}
```
このコードでは以下のような事が起きていると言えます。
```cpp
int main()
{
    char c; // 1バイト分領域を確保しろ
} // スコープから外れるので変数cを破棄しろ
```
このように宣言/定義された変数はスコープが終わると同時に、データが破棄されます。破棄される事により、スコープ外からそのデータに対してアクセスする事はできません。