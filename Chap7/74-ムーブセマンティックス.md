## 7.4 ムーブセマンティックス

これまでに、コピー、アドレス/参照など、様々な方法でデータに対する操作を行ってきましたが、それに加えてもう一つ、ムーブという概念について説明します。ムーブの概要を理解したら、その仕組みを理解するためglvalueとrvalue、そしてそれぞれが内包している細かい概念を説明していきます。

### 7.4.1 ムーブの概念とその利用

### 7.4.2 用語とムーブセマンティックスの種明かし

#### glvalue
glvalueとは、generalized lvalueの略です。この概念は以下に説明する概念を内包した総合的なlvalueの総称と言えます。

##### lvalue
そもそも、lvalueをまだ説明していませんでした。
lvalueとはlocator valueの略です。
```cpp
// 変数iが宣言されているとする...

i = 42;
// iは式のうちiの値を格納した場所に対して名付けられた識別子名。
// locator(場所) valueを略してlvalue
```
この場合、`i`がlvalueです。
`i`は`i`の値を格納した場所に対して名付けられた識別子名です。よって`i`はlocator valueと言えます。lvalueの定義は以上です。至ってシンプルですね。

しかし、しばしば、lvalueはleft valueの略であるとされる事があります。
```cpp
// 変数iが宣言されているとする...

i = 42;
// iは式のうち左にある値。
// left(左) valueを略してlvalue
```
しかし、これは現代的なセマンティックを考えると、適切な言い方とは言えません。何故ならばleft valueというワードは、かつてムーブという概念がなかった時、単に「左の」値、「右の」値という単純な区分をしていた時代背景に起因しています。よって、より現代的な捉え方として適切な用語は、left valueではなく、locator valueであると言えるのです。そもそも、lvalueであっても右に来る事は当然ながらありますしね。
```cpp
int i = 0;
int a = i; // iはlvalue
```

また、lvalueは日本語に訳した場合、主に「左辺値」と呼ばれる事があります。しかし、その意味合いとしてはleft value的なニュアンスを含んでいる事になるため、上記の理由から現代的なlvalueに対する日本語の呼称として、「左辺値」というワードを用いる事は、厳密に精査するとあまり適切な翻訳とは言えません。

##### xvalue
xvalueはeXpiring valueの略です。意味合いとしては死にかけ(expiring)の値といったところでしょうか。まずどういう事かを理解するために、`std::move`/ムーブ操作の種明かしをする事とします。実は`std::move`/ムーブ操作は、単なるrvalue referenceへのキャストだったのです。以下のように記述する事で実はオブジェクトをムーブする事(std::moveを使うのと同じ事)ができます。
```cpp
int i=0; // iはlvalue。
int a=static_cast<int&&>(i); // rvalue referenceへのキャスト(ムーブ)。
```
この時、`i`はムーブされます。ムーブを行うという事は、ムーブされた元のオブジェクトは未定義となるのですから、それはもはや死んだ(破棄された)も同然ですね。このように、lvalueでありながら直ぐ破棄されると分かるような余命宣言をされているようなオブジェクトはxvalueとされます。


#### rvalue
rvalueはxvalueとprvalueが含んだそれらの総称です。rvalueにも前述したxvalueが含まれます。死にかけの値はlvalueともrvalueとも捉える事ができますからrvalueにもxvalueが含まれます。

##### prvalue
prvalueは、pure rvalueの略です。

### 7.4.4 相関図
以上の説明から、主にglvalue、rvalueらの相関図は以下のように捉える事が出来ます。
![](/assets/value.jpeg)